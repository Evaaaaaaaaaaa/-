[toc]



# Excel笔记

## 1. 基础

***

### 移动

* 向下移动 Enter/Return 
* 向上移动 Shift + Enter/Return 
* 向右移动 Tab 
* 向左移动 Shift + Tab 
* 或用上下左右方向键控制

**表格之间增加**

* 点击添加行上行中最后一个储存格 + Tab



### 调整栏宽列高

* **手动调节:** 拖拉标题栏位的间隔线
* **自动随栏位文字长度调节:** 双击间隔线



### 跨栏置中

* **目的:** 将多个储存格合并, 再将文字放置在合并后的储存格中间. (多用于放置标题) 
* **操作方法:** 先框选想要合并的栏位, 其次在上方功能区选择**跨栏置中**
* ![image-20210106153107340](https://tva1.sinaimg.cn/large/008eGmZEgy1gme0e1t03kj313o0bedm7.jpg)
* **取消跨栏置中:** 再次点击**跨栏置中**



### 调节多个栏宽列高

#### 多个栏宽或列高调节一致

* 框选宽度不一致的栏位 (e.g. A, B, C, D 或 1, 2, 3, 4)
* 调节任意一个间隔线拖拉到想要的宽度/高度后, 所有栏宽/列高将一致

#### 将多个栏宽或列高根据储存文字长度高度调节

* 框选宽度不一致的栏位 (e.g. A, B, C, D 或 1, 2, 3, 4)

* 双击任意一个间隔线

  

### 快速填写数字或编号技巧

1. 输入一个序列号, 例如 T001
2. 选择T001储存格右下角(鼠标变成黑十字图标)，向下拖拉后，将自动填充T002， T003...

* Excel可以自动判断一组数字的数差，并产生相同输差的数组

  * 如，数列输入T001，T003后，选择这两个存储格，点击右下角向下拖拉，下面储存格将自动填充T005，T006。

    

### 日期输入技巧

* **使用斜线“/”来隔开年月日：** 2018/10/24
  * **如果Excel将其自动转换成数字， 解决方法：**在日期前加入'，使excel把日期看作text
* **好处**：这些日期可以使用excel里的日期计算，可以进行日期格式切换：10/24 --> Oct-24
  * 框选更改格式的储存格，右键 - 选择“储存格格式(format cell)” - 选择“日期” - 选择格式 
* **快速输入今日日期：** Control + ；
* 选择右下角向下拖拉进行日期填充，右下角按钮可选择不同填充方式，列入日，月，年。



### 输入当列已存在的文字

* 右键 + “下拉式清单挑选 (choose from drop-down list)” + 选择需要的文字
* <img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gme42pnmkwj308a0bidi5.jpg" alt="Screen Shot 2021-01-06 at 17.37.10" style="zoom: 33%;" />



### 基础输入公式

1. 选择将要储存结果的储存格 

2. 在储存格或上方共识栏内输入公式，格式为：= Cell1 符号 Cell2
   * e.g.  = D3 x D4
   * 可直接点击D3和D4进行自动输入
3. 可点击右下角拖拉进行同列其他行的相同公式计算



### 复制格式

* 当需要把两列格式变成货币格式， e.g. 单价：$20
  * 框选想更改的储存格，右键+储存格格式，选择货币，或在工具栏内直接更改储存格格式
  * **复制格式：**选择已更改格式的储存格，在Home（常用）栏内，选择左上角的刷子后框选即将进行更改的储存格，格式将被复制。



## 2. 表格设计

***

### 添加表格线

* **问题：**当想要打印表格时，表格框线将会消失

* **解决办法：**

  1. 为表格快速画线
     * line color/ line style更改线颜色和格式
     * Draw boarder：画外围表格线 | Draw boarder grid：画网格
     * <img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gme743lj6vj30sy10k7ok.jpg" alt="image-20210106191605383" style="zoom: 25%;" />
     * Shift + 鼠标移动 ---> 橡皮
  2. 先选取想要画线的范围，在选择相应的格式（上图前三栏）。

  



###  添加背景图片

* page layout  - background - 选择图片
* 删除图片上的表格线：page layout - 取消选择gridlines内的view
* 可改变表格内的背景颜色使表格更清晰
* 可利用添加空白行列并设置为相同背景颜色 --> 实现加入表格边缘
  * <img src="/Users/eva/Library/Application%20Support/typora-user-images/image-20210106194759246.png" alt="image-20210106194759246" style="zoom:33%;" />

### 自动加总

1. 选择输入结果的储存格，点击home - auto-sum 自动加总
2. or 输入“ =SUM(start cell : end cell)”
3. or 输入 “=SUM() + 框选需要被相加的表格” （按住command键去框选不相连的储存格） 

* <img src="/Users/eva/Library/Application%20Support/typora-user-images/image-20210106201206747.png" alt="image-20210106201206747" style="zoom:25%;" />

## 3. 冻结窗格 & 分割视窗

***

### 冻结窗格

* **问题：**表格长度宽度增加，上下左右滑看不到格列标题。

* **解决方法：**

  1. 框选标题下面的整行，e.g. 标题行为2，选择行数3.

  2. 点击view - window freeze
  3. 效果：行1-2将不会因为上下滑动而改变位置



### 分割视窗

* **问题：**比较距离较远的行或列，需要滚动并且很难比较。

* **分割视窗：**可将表格分割成两个不同的区域，并且两个视窗都可以进行独立的卷动。

* **方法：**

  1. 选择分割的行数

  2. 点击view - split（分割）

  3. 拖动分割线调整两个视窗的大小

     

## 4. 资料排序

***

### 排序

* 排序目标：数字, 日期，中文，英文。
  * **注意：**中文排序A-Z --> 笔画从少到多

#### **单列排序**：

* 选择排序列**任意**储存格，点击常用 -排序与筛选 - 选择排序方法

#### **多列排序：**

* 点击常用 - 排序与筛选 - 自定排序
  * 第一层排序：选择第一层排序栏，对象，以及顺序
  * 第二层排序：点击“+”/新增层级，选择第二层排序栏，对象，以及顺序

* **使用场景：**第一层：产品名称， 第二层：单价（小-->大）

  * | 产品名称 | 单价 | 数量 | 总金额 |
    | -------- | ---- | ---- | ------ |
    | 梨       | $5   | 2    | $10    |
    | 梨       | $8   | 3    | $24    |
    | 苹果     | $10  | 4    | $40    |
    | 葡萄     | $30  | 3    | $90    |
    | 香蕉     | $20  | 5    | $100   |

#### 自定清单

1. 点击home - sort & fillter - 自定排序
2. 选择正确的排序栏，对象
3. 在顺序栏下拉表中选择自定清单，选择已定义清单或根据自己需求重新定义清单

* **使用场景：**需要固定排列顺序，e.g.上表格中，葡萄 -- 梨 -- 苹果 -- 香蕉



## 5. 资料筛选

***

* 只展示符合要求的数据在图表中

### 单列筛选

1. 点击任意储存格，点击**常用-排序与筛选-筛选**，每列标题列的位置出现下拉列表图标
2. 选择需要设置限制的列，点击下拉列表图标，只选择符合要求的选项

### 多列筛选

* 在想要筛选的列中重复单列筛选步骤

### 还原表格

* **常用-排序与筛选-清除**

### 文字模糊筛选

* 使用场景：在名字列中找到所有姓王的人名
* **方法： 常用-排序与筛选-筛选，点击名字列标题的下拉表-文字筛选-开始于-输入“王”-确定**
* 可以用在文字，数字，时间列

### 色彩排序/筛选

* 如表格列储存格有背景颜色，可以通过颜色排序或筛选



## 6. 表格格式

***

* 给表格增添格式，增强表格视觉感观并使数据更清晰展示
* **方法：**
  * **home - 格式化为表格**，确认表格范围并勾选表格是否有标题
  * 从表格样式下拉选单里找到合适格式
  * 如果表格样式的颜色不合适，可以从**版面配置-色彩**中选择其他颜色
* **恢复最初格式：**
  * 设计-表格格式中选择无
  * 并选择准还为范围



##  7. 交叉分析筛选器

***

* 选择多列，进行快速交叉筛选
* **设计 - 插入交叉分析筛选器** - 选择需要被筛选的一列或多列 
* 每个选择的列将产生一个面板，通过这些面板来实现多层多项筛选 （+control多选值）



## 8. 函数

***

### 基础函数

* **总和：**=SUM(range) --> 例如：=SUM(A1:A10)

* **平均值：**=AVERAGE(range)

* **最大值：**=MAX(range) 

* **第几大：**=LARGE(range, index) --> 例如：=LARGE(A1:10, 2)将计算A1到A10中最大的数字

* **第几小**：=SMALL(range, index) 

  

###  IF函数

* **公式**：=IF(条件，成立结果，不成立结果)
  * <img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gmgf34un5fj30hw074jt5.jpg" alt="image-20210108173054580" style="zoom:50%;" />



**IFS函数：(2016版本以上)**

* 当需要判断多个条件时使用 (最多128个条件)
* **公式：**=IFS(条件1，条件1成立结果，条件2，条件2成立结果...)
* 例子：=IFS(A1>=80,"H1",A1>=65,"H2",A1>=60,"pass",A1<50,"fail")



### 巢状IF

* 同样可以判断多个条件时使用，需要手动输入。
* =IF(条件1，成立结果，IF(条件2，成立结果，条件不成立结果))
* 可叠加64层，但是公式将随着层数增加而变得复杂



VLOOPUP

* 一般来说，表格里都会有一列是primary key，比如订单号，学号，姓名(大部分)。这列的每个值只会出现一次。当我们已知primary key的值，想查询同行其他值是可以使用VLOOKUP。比如学号1，我们想帮学号为1的同学查询她的成绩时。
  * <img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gmgg5vr6rjj30ee04qmyd.jpg" alt="image-20210108180812662" style="zoom:50%;" />
* **公式：VLOOPUP(Lookup_value, Table_array, Col_index_num, Range_lookup).**
  * **Lookup_value:** 这里指我们要根据哪一个储存格里的值来查找。在上面的例子中为学生号001的储存格位置。
  * **Table_array:** 从哪里查询，框选表格范围。**注意，学号列需要在被框选的表格范围内的最左列。**
  *  **Col_index_num：**指查找列的索引，根据上表格，成绩result在表格的第3列，所以这里填入3
  * **Range_lookup**：此处填写**TRUE/FALSE**，表示是否使用**范围查找**。**在此例子中精准查找是必要的，因为需要学生号必须等于1，所以这里要写FALSE**
* 注意：
  1. 当Range_lookup被设置为TURE（找最接近值）的时候，当列需要是递增顺排列
  2. 选择Table_array + F4 --->\$A1\$:\$A3\$. 当下拉结果到当列后续行时，Table_array的范围将会被固定，否则会产生错误。
  3. 如需搜索学号1同学的多个信息，比如名字和成绩，并且写在同列里，学号是不变的。我们需要选择Lookup_value + F4 ---> \$1\$来给查询值上锁，下图为列。
     * ![Screen Shot 2021-01-08 at 20.45.04](https://tva1.sinaimg.cn/large/008eGmZEgy1gmgkpjhljwj307602sq39.jpg)

